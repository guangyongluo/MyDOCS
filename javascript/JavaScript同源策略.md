### JavaScript同源策略
同源策略是对JavaScript代码能够操作哪些Web内容的一条完整的安全限制。当Web页面使用多个<iframe>元素或者打开其他浏览器窗口的时候，
这一策略通常就会发挥作用。在这种情况下，同源策略负责管理窗口或窗体中的JavaScript代码及和其他窗口或帧的交互。具体来说，脚本只
能读取和所属文档来源相同的窗口和文档的属性。文档的来源包含协议、主机、以及载入文档的URL端口。从不同Web服务器载入的文档具有不
同的来源。通过同一主机的不同端口载入的文档具有不同的来源。使用http:协议载入的文档和使用https:协议载入的文档具有不同的来源，即
使它们来自同一个服务器。脚本本身的来源和同源策略并不相关，相关的是脚本所嵌入的文档的来源，理解这一点很重要。例如，假设一个来
自主机A的脚本被包含到(使用<script>标记的src属性)宿主B的一个Web页面中。这个脚本的来源是主机B，并且可以完整地访问包含它的文档的
内容。如果脚本打开一个新窗口并载入来自主机B的另一个文档，脚本对这个文档的内容也是具有完全的访问权限。但是，如果脚本打开第三个
窗口并载入一个来自主机C的文档(或者是来自主机A)，同源策略就会发挥作用，阻止脚本访问这个文档。实际上，同源策略并非应用于不同源的
窗口中的所有对象的所有属性。不过它应用到了其中的大多数属性，尤其是对Document对象的几乎所有属性而言。凡是包含另一个服务器中文档
的窗口或窗体，都是同源策略适用的范围。如果脚本打开一个窗口，脚本也可以关闭它，但不能以任何方式查看窗口内部。同源策略还应用与使
用XMLHttpRequest生成的HTTP请求。这个对象允许客户端JavaScript生成任意的HTTP请求到脚本所属文档的Web服务器，但是不允许脚本和其他
Web服务器，但是不允许脚本和其他Web服务器通信。

###### 同源策略的含义
我们都知道JavaScript可以操作web文档的内容，试想，如果不对这一点加以限制，那么JS可以做的事情就太多了，危险性也太高，所以就针对
它可以操作哪些文档的内容有了一个限制，这个限制就是同源策略。同源策略在什么情况下会起作用呢？当web页面使用多个<iframe>元素或者
打开其他浏览器窗口的时候，这一策略就会起作用。同源策略的含义：脚本只能读取和所属文档来源相同的窗口和文档的属性。

###### 同源的判定
这里就涉及到了一个浏览器如何判断两者是否同源以及如何判断脚本来源的问题。***注意一点：脚本本身的来源并不作为判断是否同源的依
据，而是将脚本所属文档的来源作为判断依据。***
* 1. 判断脚本来源
        例如：文档A中通过script的src引用了一个外部脚本，这个脚本时google提供的，也是从google的主机上加载到文档A中的，那么这个
        脚本的所属文档是谁呢，答案是文档A。
* 2. 判断是否同源
        理解了脚本来源，接着理解怎么判断是否同源：如果两个文档在 ***协议、主机以及载入文档的URL端口*** 这三点中有一点不同，就认为他们不
        同源。

###### 不严格同源策略
同源策略固然在安全性上有了很大提高，但这种做法属于“宁可错杀三千，不可放过一个”。如果一个多域名站点需要在不同的子域之间共享属性，同
源策略就会变得很烦人了。以下介绍三种实现“不严格的同源策略”的方法：
* 1. 使用Document对象的domain属性，默认情况下，属性domain存放的是载入文档的服务器的主机名。这一属性是可写的。如果两个窗口包含的脚本把
domain设置为了相同的值，那么这两个窗口就不再受同源策略的约束，它们就可以相互读取对方的属性。
* 2. 跨域资源共享（Cross-Origin Resource Sharing）：这种方法用新的“Origin：”请求头和新的响应头“Access-Control-Allow-Origin”来扩展
HTTP。它允许服务器用头信息显示地列出源，或使用通配符来匹配所有的源并允许由任何地址请求文件。
* 3. 跨文档消息（Cross-Document Messaging）：允许来自一个文档的脚本可以传递文本消息到另一个文档里的脚本，不管来源是否相同。调用window
对象的postMessage()方法，可以异步传递消息事件（可以用onmessage事件的处理程序函数来处理它）到窗口的文档里。一个文档里的脚本还是不能调用
在其他文档里的方法和读取属性，但它们可以用这种消息传递技术来实现安全的通信。

