## Git diff

### Git diff 概要
Git中的命令`git diff`像UNIX系统中的`diff`命令一样可以进行文件间的比较。而且，像`diff -r`命令一样，Git可以遍历两个树对象，同时显示它们之间的差别。但是`git diff`还有它自己的细微差别和针对Git用户的特殊需求定制的强大功能。

如果你选择了两个不同的根级树对象进行比较，`git diff`将会得到这两个项目状态的所有不同。这个功能非常强大。可以用这个diff从一个项目状态装换到另一个。以下是三个可供树或类树对象使用`git diff`命令的基本来源：
* 整个提交图中的任意树对象
* 工作目录
* 索引  
`git diff`命令可以使用上述三种来源的组合来进行如下四中基本比较：
1. `git diff`会显示工作目录和索引之间的差异。同时它会显示工作目录里什么是“脏的”，并把这个“脏”文件作为下个提交暂存的候选。这条命令不会显示索引中的和永久存在版本库中的文件的不同（更不必说可能相关的远程版本库）。
2. `git diff commit`这个形式命令会显示工作目录和给定提交时间的差异。常见的一种用法是用HEAD或者一个特定的分支名作为commit。
3. `git diff --cached commit`这条命令会显示索引中的变更中和给定提交的变更之间的差异。如果省略commit这一项，则默认为HEAD。使用HEAD，该命令会显示下次提交会如何修改当前分支。
4. `git diff commit1 commit2`如果你任意指定两个提交，这条命令会显示它们之间的差异。这条命令会忽略索引和工作目录，它是任意比较对象库中两个对象的实际执行方法。  
命令行的参数个数决定使用哪种基本形式和比较什么。可以比较任意两个提交或树。比较的两个对象不需要有一个直接的或间接地父子关系。如果你省略了一个或两个参数，那么git diff命令会比较默认的对象，比如，索引或者工作目录。
>在版本库中有几个重要的对象树，一个工作目录为一个临时的对象树，索引为一个临时的对象树，还有就是Git版本库中的所有提交都是一个对象树。`git diff`的作用就是比较各个对象树中的差异。  

### git diff 参数
* -w 或者 --ignore-all-space 这两个选项令比较忽略空白字符
* --stat 这个选项会显示针对两个树状态之间的差异的统计数据。报告用简洁的语法显示有多少行发生了改变，有多少行添加了， 有多少行删除。
* --color 这个选项会使输出结果使用多种颜色显示，一种颜色显示diff中的一种变化。

>**当你的工作目录、索引和版本库都不相同时，请记住`git commit`永远只会提交在索引中的状态**

### git diff 和 git log
`git diff`不关心它比较的文件的历史，也不关心分支，而`git log`特别关注一个文件是如何变成另一个的。`git log`和`git diff`这两个命令都接受commit1..commit2这样的参数来产生一个对称差(symmetrical difference)。然而，跟之前一样，它们会产生不同的结果。命令`git log commit1..commit2`显示的是各自可达又不同时可达的提交。对称差在`git diff`中会显示commit2与commit1的共同祖先（或者合并基础[merge base]之间的差异）。

### git diff限制路径
默认情况下，`git diff`操作会基于从给定树对象的根开始的整个目录结构。然而，可以使用和`git log`中相同的路径限制(path limiting)手段来限制`git diff`只输出版本库的一个子集。可以显示某个目录中的文件变化，也可以显示某个确定文件的变化。参看如下的例子：
```
#只显示Documentation的更改
git diff --stat master~5 master Documentation
#只显示Documentation/git-add.txt
git diff --stat master~5 master Documnetation/git-add.txt
```
**在Git中每个提交都包含一整棵树，也就是该提交包含的文件列表。每个树都是独立的。**
